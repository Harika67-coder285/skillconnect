{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Browse Freelancers - SkillConnect</title>

  <!-- Bootstrap (optional, used for grid & helpers) -->
<link href="{% static 'vendor/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">

<link href="{% static 'vendor/bootstrap-icons/bootstrap-icons.css' %}" rel="stylesheet">
  <!-- Optional: your main CSS (keeps consistent look) -->
<link href="{% static 'css/main.css' %}" rel="stylesheet">

  <!-- Page-specific CSS (embedded so browse.html works standalone) -->
  <style>
    :root{
      --accent:#0d83fd;
      --card-bg:#ffffff;
      --muted: #6c757d;
      --radius:12px;
      --shadow: 0 8px 30px rgba(14, 30, 37, 0.06);
    }

    body{
      font-family: "Roboto", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: #f5f7fb;
      color: #212529;
      margin: 0;
      padding-top: 88px; /* leave space for fixed header */
    }

    /* Header tweak (so header from your template remains fixed) */
    header.header { position: fixed; top:0; left:0; right:0; z-index: 999; background: rgba(255,255,255,0.97); box-shadow: 0 2px 12px rgba(0,0,0,0.05); }

    .page-hero{
      padding: 40px 0;
      background: linear-gradient(180deg,#ffffff 0%, #f7f9fc 100%);
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }
    .page-hero .container { display:flex; align-items:center; justify-content:space-between; gap:16px; flex-wrap:wrap; }

    .search-wrap {
      display:flex;
      gap:8px;
      width: 100%;
      max-width: 820px;
    }

    .search-wrap .form-control {
      border-radius: 10px;
      padding: 12px 14px;
      border: 1px solid rgba(0,0,0,0.08);
      box-shadow:none;
    }

    .search-wrap .btn {
      border-radius: 10px;
      padding: 10px 18px;
    }

    .filters {
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .chip {
      background: #fff; padding:8px 12px; border-radius: 20px; border:1px solid rgba(0,0,0,0.06); font-size:14px;
      display:inline-flex; align-items:center; gap:8px;
    }

    .results {
      padding: 36px 0;
    }

    .grid {
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    /* Freelancer Card */
    .freelancer-card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
      display:flex;
      gap: 16px;
      align-items:flex-start;
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .freelancer-card:hover { transform: translateY(-6px); box-shadow: 0 14px 30px rgba(14,30,37,0.12); }

    .freelancer-avatar {
      width:88px; height:88px; border-radius:12px; overflow:hidden; flex-shrink:0;
      border: 1px solid rgba(0,0,0,0.04);
    }
    .freelancer-avatar img { width:100%; height:100%; object-fit:cover; display:block; }

    .freelancer-body { flex:1; min-width:0; }
    .freelancer-head {
      display:flex; justify-content:space-between; align-items:flex-start; gap:12px;
    }
    .freelancer-name { font-weight:700; margin:0; font-size:1.05rem; }
    .freelancer-role { color:var(--muted); font-size:0.95rem; margin-top:4px; }

    .freelancer-tags { display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 12px; }
    .tag { background:#f1f6ff; color:var(--accent); border-radius:10px; padding:6px 10px; font-size:13px; font-weight:600; border:1px solid rgba(13,131,253,0.06); }

    .freelancer-meta { display:flex; gap:16px; color:var(--muted); font-size:14px; align-items:center; flex-wrap:wrap; }

    .rating { display:inline-flex; gap:6px; align-items:center; color:#f5a623; font-weight:700; }
    .hourly { background: #ecf6ff; color: #003a8c; padding:6px 10px; border-radius:8px; font-weight:700; }

    .cta-col { display:flex; flex-direction:column; gap:8px; align-items:flex-end; }
    .btn-hire { background: var(--accent); color: #fff; border: none; padding: 8px 14px; border-radius:10px; font-weight:600; }
    .btn-view { background: transparent; border: 1px solid rgba(0,0,0,0.08); padding: 8px 12px; border-radius:10px; color:var(--muted); }

    /* Empty / no results */
    .no-results { text-align:center; padding: 60px 20px; color:var(--muted); }

    /* Responsive */
    @media (max-width: 1024px){
      .grid { grid-template-columns: repeat(2, 1fr); }
      .page-hero .container { flex-direction:column; align-items:flex-start; gap:12px; }
    }
    @media (max-width: 640px){
      .grid { grid-template-columns: 1fr; }
      body { padding-top: 110px; }
      .freelancer-avatar { width:72px; height:72px; border-radius:10px; }
      .cta-col { align-items:flex-start; }
    }

  </style>
<link href="{% static 'css/main.css' %}" rel="stylesheet">
</head>
<body class="index-page">

  <!-- Header: copied from your template so links & mobile toggle work -->
  <header id="header" class="header d-flex align-items-center fixed-top">
  <div class="header-container container-fluid container-xl position-relative d-flex align-items-center justify-content-between">

    <a href="{% url 'home' %}" class="logo d-flex align-items-center me-auto me-xl-0">
      <img src="{% static 'img/logo.png'%}" alt="SkillConnect Logo" />
      <h1 class="sitename">SkillConnect</h1>
    </a>

    <nav id="navmenu" class="navmenu">
  <ul>

    <!-- Home -->
    <li><a href="{% url 'home' %}" class="active">Home</a></li>

    <!-- Categories Dropdown -->
    <li class="dropdown">
      <a href="#"><span>Categories</span> <i class="bi bi-chevron-down toggle-dropdown"></i></a>
      <ul>
        <li><a href="{% url 'browse' %}?cat=webdev">Web Development</a></li>
        <li><a href="{% url 'browse' %}?cat=mobile">Mobile Apps</a></li>
        <li><a href="{% url 'browse' %}?cat=datascience">Data Science</a></li>
        <li><a href="{% url 'browse' %}?cat=design">Graphic & UI/UX Design</a></li>
        <li><a href="{% url 'browse' %}?cat=writing">Content Writing</a></li>
        <li><a href="{% url 'browse' %}?cat=marketing">Digital Marketing</a></li>
        <li><a href="{% url 'browse' %}?cat=video">Video Editing</a></li>
        <li><a href="{% url 'browse' %}?cat=ai">AI & Machine Learning</a></li>
        <li><a href="{% url 'browse' %}?cat=business">Business & Finance</a></li>
      </ul>
    </li>

    <!-- Static Links -->
    <li><a href="{% url 'browse' %}">Find Freelancers</a></li>
    <li><a href="{% url 'how_it_works' %}">How It Works</a></li>

    <!-- Profile Avatar -->
    <li>
      <a href="{% url 'dashboard' %}" class="profile-avatar">
        <img src="{% static 'img/avatar-1.webp' %}" alt="Profile" />
      </a>
    </li>

    <!-- Login / Signup -->
    <li><a href="{% url 'login_page' %}" class="btn-getstarted" style="padding:10px 20px;">Login</a></li>
    <li><a href="{% url 'register_page' %}" class="btn-getstarted" style="padding:10px 20px;">Sign Up</a></li>

  </ul>

  <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
</nav>


  </div>
</header>
  <!-- Hero / Search -->
  <section class="page-hero">
    <div class="container">
      <div style="flex:1; min-width:260px;">
        <h2 style="margin:0 0 6px 0; font-weight:700;">Find top freelancers</h2>
        <p style="margin:0; color:var(--muted)">Browse verified freelancers, filter by skills, rating, hourly rate and location.</p>
      </div>

      <div style="flex:1; display:flex; justify-content:flex-end;">
        <form class="search-wrap" onsubmit="event.preventDefault(); applyFilters()">
          <input id="q" class="form-control" placeholder="Search freelancers, skills or keywords (e.g. React, UI/UX, Python)" />
          <select id="skill" class="form-control" style="max-width:200px;">
            <option value="">All skills</option>
            <option value="webdev">Web Development</option>
            <option value="design">Design</option>
            <option value="datasci">Data Science</option>
            <option value="mobile">Mobile Apps</option>
          </select>
          <button class="btn btn-primary" type="submit">Search</button>
        </form>
      </div>

      <div class="filters" style="width:100%; margin-top:12px;">
        <div class="chip"> <i class="bi bi-geo-alt"></i> India</div>
        <div class="chip"> <i class="bi bi-star-fill" style="color:#f5a623"></i> 4.5+</div>
        <div class="chip"> <i class="bi bi-clock"></i> Hourly</div>
        <div class="chip"> <i class="bi bi-award"></i> Top Rated</div>
      </div>
    </div>
  </section>

  <!-- Results -->
  <main class="results container">
    <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;">
      <div style="font-weight:700; font-size:18px;">Showing <span id="count">6</span> freelancers</div>
      <div style="color:var(--muted)">Sort by:
        <select id="sort" onchange="applyFilters()" style="border:0; background:transparent; color:var(--muted); font-weight:600;">
          <option value="relevance">Relevance</option>
          <option value="rating">Rating</option>
          <option value="hourly_low">Hourly: Low to High</option>
          <option value="hourly_high">Hourly: High to Low</option>
        </select>
      </div>
    </div>

    <div style="height:18px;"></div>

    <div id="grid" class="grid">
      <!-- Cards are injected by JS below, or you can keep these as static copies -->
    </div>

    <div id="no-results" class="no-results" style="display:none;">
      <p style="font-size:18px;">No freelancers match your search.</p>
      <p style="color:var(--muted); margin-top:6px;">Try clearing filters or try a different keyword.</p>
    </div>
  </main>

  <!-- Footer (simple) -->
  <footer style="padding:40px 0; text-align:center; color:var(--muted);">
    © <strong>SkillConnect</strong> • Demo browse page
  </footer>

  <!-- Sample data + small script to render hardcoded users -->
<script>
  // Highlight the current nav link
  
  document.addEventListener("DOMContentLoaded", function () {
    const isLoggedIn = localStorage.getItem("isLoggedIn") === "true";

    // Find the dashboard link
   const dashboardLink = document.querySelector('a["{% url "dashboard" %}"]');
   const profileIcon = document.querySelector('.profile-avatar');

if (isLoggedIn && profileIcon) {
  profileIcon.style.display = 'inline-block'; // show avatar
} else if(profileIcon) {
  profileIcon.style.display = 'none'; // hide if not logged in
}

    if (dashboardLink) {
      if (isLoggedIn) {
        dashboardLink.style.display = "inline-block !important"; // show if logged in
        
      } else {
        dashboardLink.style.display = "none !important"; // hide if not logged in
      }
    }


const loginLink = document.querySelector('a[href="{% url "login_page" %}"]');
    const signupLink = document.querySelector('a[href="{% url "register_page" %}"]');
    if (isLoggedIn) {
      if (loginLink) loginLink.textContent = "Logout";
      if (loginLink) loginLink.href = "#";
      if (signupLink) signupLink.style.display = "none";

      // Logout functionality
      if (loginLink) loginLink.addEventListener("click", function (e) {
        e.preventDefault();
        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("loggedInUser");
        window.location.reload(); // refresh page
      });
    }
  });
  const navLinks = document.querySelectorAll('#navmenu ul li a');

  // Add click listener to update active class
  navLinks.forEach(link => {
    link.addEventListener('click', function() {
      navLinks.forEach(l => l.classList.remove('active'));
      this.classList.add('active');
    });
  });

  // Automatically set active link based on current URL
  const currentPage = location.pathname.split("/").pop(); // e.g., "browse.html"
  navLinks.forEach(link => {
    const href = link.getAttribute('href');
    if(href === currentPage){
      link.classList.add('active');
    }
  });

  // Mobile nav toggle + dropdown functionality
  (function() {
    const mobileToggle = document.querySelector('.mobile-nav-toggle');
    const navmenu = document.querySelector('#navmenu');

    if(mobileToggle && navmenu){
      mobileToggle.addEventListener('click', function(e){
        e.preventDefault();
        document.body.classList.toggle('mobile-nav-active');
        this.classList.toggle('bi-list');
        this.classList.toggle('bi-x');
      });
    }

    // Dropdown toggles
    const dropdownToggles = document.querySelectorAll('#navmenu .dropdown > a');
    dropdownToggles.forEach(btn => {
      btn.addEventListener('click', function(e){
        if(window.innerWidth <= 1199){
          e.preventDefault();
          const parentLi = this.parentElement;
          const submenu = parentLi.querySelector('ul');
          if(!submenu) return;
          const isOpen = submenu.classList.contains('dropdown-active');
          parentLi.querySelectorAll('.dropdown-active').forEach(el => el.classList.remove('dropdown-active'));
          if(!isOpen) submenu.classList.add('dropdown-active');
          else submenu.classList.remove('dropdown-active');
        }
      });
    });

    // Close mobile nav when clicking outside
    document.addEventListener('click', function(e){
      if(!navmenu.contains(e.target) && !mobileToggle.contains(e.target) && document.body.classList.contains('mobile-nav-active')){
        document.body.classList.remove('mobile-nav-active');
        mobileToggle.classList.remove('bi-x');
        mobileToggle.classList.add('bi-list');
      }
    });

    // Close mobile nav with Escape
    document.addEventListener('keyup', function(e){
      if(e.key === 'Escape' && document.body.classList.contains('mobile-nav-active')){
        document.body.classList.remove('mobile-nav-active');
        mobileToggle.classList.remove('bi-x');
        mobileToggle.classList.add('bi-list');
      }
    });
  })();

  // Freelancer data + render logic remains unchanged
  const freelancers = [
    { id:1, name:"Asha Reddy", role:"Senior Frontend Developer", skills:["React","Next.js","Tailwind"], rating:4.9, reviews:124, hourly:18, location:"Hyderabad, India", avatar:"{% static 'img/avatar-1.webp'%}", tagline:"Building fast, accessible UI for startups." },
    { id:2, name:"Rahul Kumar", role:"Full Stack Developer", skills:["Node.js","Express","MongoDB"], rating:4.7, reviews:98, hourly:20, location:"Bengaluru, India", avatar:"{% static 'img/avatar-2.webp'%}", tagline:"APIs, servers and scalable systems." },
    { id:3, name:"Sneha Joshi", role:"UI/UX Designer", skills:["Figma","UX Research","Webflow"], rating:4.8, reviews:210, hourly:22, location:"Mumbai, India", avatar:"{% static 'img/avatar-3.webp'%}", tagline:"Designing simple, high-conversion experiences." },
    { id:4, name:"Vikram Singh", role:"Data Scientist", skills:["Python","Pandas","Machine Learning"], rating:4.6, reviews:76, hourly:25, location:"Delhi, India", avatar:"{% static 'img/avatar-4.webp'%}", tagline:"ML models and predictive analytics for products." },
    { id:5, name:"Maya Patel", role:"Mobile App Developer", skills:["Flutter","Dart","Firebase"], rating:4.9, reviews:144, hourly:28, location:"Ahmedabad, India", avatar:"{% static 'img/avatar-5.webp'%}", tagline:"Cross-platform apps with beautiful UI & performance." },
    { id:6, name:"Arjun Das", role:"DevOps Engineer", skills:["Docker","Kubernetes","AWS"], rating:4.5, reviews:60, hourly:30, location:"Pune, India", avatar:"{% static 'img/avatar-6.webp'%}", tagline:"Reliable CI/CD and infra automation." }
  ];

  const grid = document.getElementById('grid');
  const countEl = document.getElementById('count');
  const noResults = document.getElementById('no-results');

  function createCard(user){
    const div = document.createElement('div');
    div.className = 'freelancer-card';
    div.innerHTML = `
      <div class="freelancer-avatar"><img src="${user.avatar}" alt="${user.name}"></div>
      <div class="freelancer-body">
        <div class="freelancer-head">
          <div style="min-width:0">
            <div style="display:flex; gap:8px; align-items:center;">
              <div>
                <p class="freelancer-name">${user.name}</p>
                <div class="freelancer-role">${user.role} · <span style="color:var(--muted); font-weight:600;">${user.location}</span></div>
              </div>
            </div>
            <div style="margin-top:8px; color:var(--muted); font-size:14px;">${user.tagline}</div>
          </div>
          <div class="cta-col">
            <div class="freelancer-meta" style="justify-content:flex-end;">
              <div class="rating">${user.rating} <i class="bi bi-star-fill"></i> <span style="color:var(--muted); font-weight:500;">(${user.reviews})</span></div>
              <div class="hourly">₹${user.hourly}/hr</div>
            </div>
            <div style="display:flex; gap:8px;">
              <button class="btn btn-view" onclick="viewProfile(${user.id})">View</button>
              <button class="btn btn-hire" onclick="hire(${user.id})">Hire</button>
            </div>
          </div>
        </div>
        <div class="freelancer-tags">${user.skills.map(s=>`<span class="tag">${s}</span>`).join('')}</div>
        <div class="freelancer-meta">
          <div><i class="bi bi-briefcase"></i> ${Math.floor(user.reviews/2)} projects</div>
          <div><i class="bi bi-award"></i> Top rated</div>
        </div>
      </div>
    `;
    return div;
  }

  function render(list){
    grid.innerHTML = '';
    if(!list || list.length === 0){
      noResults.style.display = 'block';
      countEl.textContent = 0;
      return;
    } else { noResults.style.display = 'none'; }
    countEl.textContent = list.length;
    list.forEach(u => grid.appendChild(createCard(u)));
  }

  render(freelancers);

  function applyFilters(){
    const q = (document.getElementById('q').value || '').toLowerCase().trim();
    const skill = (document.getElementById('skill').value || '').toLowerCase();
    const sort = document.getElementById('sort').value;

    let list = freelancers.filter(u=>{
      const inQ = q === '' || u.name.toLowerCase().includes(q) || u.role.toLowerCase().includes(q) || u.skills.join(' ').toLowerCase().includes(q) || u.tagline.toLowerCase().includes(q);
      const inSkill = skill === '' || u.skills.join(' ').toLowerCase().includes(skill);
      return inQ && inSkill;
    });

    if(sort==='rating') list.sort((a,b)=>b.rating-a.rating);
    if(sort==='hourly_low') list.sort((a,b)=>a.hourly-b.hourly);
    if(sort==='hourly_high') list.sort((a,b)=>b.hourly-a.hourly);

    render(list);
  }

  function viewProfile(id){ const u = freelancers.find(x=>x.id===id); alert("Open profile page for: "+u.name); }
  function hire(id){ const u = freelancers.find(x=>x.id===id); alert("Start hiring flow for: "+u.name); }

</script>


  <script src="{% static 'vendor/bootstrap/js/bootstrap.bundle.min.js' %}"></script>

</body>
</html>
